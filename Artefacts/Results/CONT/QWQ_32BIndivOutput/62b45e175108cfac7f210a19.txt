

def validate_fixity(self, fixity, manifest_files):
    required_keys = {"filename", "algorithm", "value"}
    for entry in fixity:
        if not required_keys.issubset(entry.keys()):
            return self.error("Fixity entry missing required keys")
        if entry["filename"] not in manifest_files:
            return self.error(f"File {entry['filename']} not in manifest")
    return True