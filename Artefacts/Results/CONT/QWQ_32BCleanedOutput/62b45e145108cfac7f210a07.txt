def validate(self, inventory, extract_spec_version=False):
    spec_version = None
    if extract_spec_version:
        type_val = inventory.get('type')
        if type_val:
            spec_version = type_val
        else:
            spec_version = self.spec_version
    else:
        spec_version = self.spec_version

    required_keys = []
    if spec_version == '1.0':
        required_keys = ['id', 'name']
    elif spec_version == '2.0':
        required_keys = ['id', 'name', 'type']
    else:
        raise ValueError(f"Unsupported spec version: {spec_version}")

    for key in required_keys:
        if key not in inventory:
            raise ValueError(f"Missing required key '{key}' for spec version {spec_version}")

    return True