def validate_version_inventories(self, version_dirs):
    root_digests = self.root_inventory.get_digests()
    differing_digests = set()
    for version_dir in version_dirs:
        inventory = self.get_inventory(version_dir)
        if not inventory:
            raise ValueError(f"Inventory missing for version directory {version_dir}")
        current_digests = inventory.get_digests()
        for digest in current_digests:
            if digest not in root_digests:
                differing_digests.add(digest)
    self.differing_digests = differing_digests