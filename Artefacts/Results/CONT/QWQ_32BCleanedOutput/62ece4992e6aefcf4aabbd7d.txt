import subprocess
import os

def subprocess_run_helper(func, *args, timeout, extra_env=None):
    module = func.__module__
    func_name = func.__name__
    code = f"import sys; from {module} import {func_name}; {func_name}(*sys.argv[1:])"
    cmd = ['python', '-c', code] + list(args)
    env = os.environ.copy()
    if extra_env:
        env.update(extra_env)
    return subprocess.run(cmd, timeout=timeout, env=env)