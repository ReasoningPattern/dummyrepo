

```python
import os
import subprocess

def prepare_repository_from_archive(
    archive_path: str,
    filename: Optional[str] = None,
    tmp_path: Union[PosixPath, str] = "/tmp",
) -> str:
    archive_filename = os.path.basename(archive_path)
    archive_type = None
    if archive_filename.endswith('.zip'):
        archive_type = 'zip'
    elif archive_filename.endswith('.tar.gz') or archive_filename.endswith('.tar'):
        archive_type = 'tar'
    elif archive_filename.endswith('.tar.bz2'):
        archive_type = 'tarbz2'
    elif archive_filename.endswith('.gz'):
        archive_type = 'gz'
    else:
        archive_type = 'zip'

    tmp_dir = tmp_path / archive_filename
    os.makedirs(tmp_dir, exist_ok=True)

    if archive_type == 'zip':
        command = ['unzip', '-q', '-d', tmp_dir, archive_filename]
    elif archive_type == 'tar':
        command = ['tar', '-xzf', archive_filename, '-C', tmp_dir]
    elif archive_type == 'tarbz2':
        command = ['tar', '-xjf', archive_filename, '-C', tmp_dir]
    elif archive_type == 'gz':
        command = ['gunzip', '-c', archive_filename, '|', 'tar', '-xvf', '-', '-C', tmp_dir]
    else:
        command = ['unzip', '-q', '-d', tmp_dir, archive_filename]

    subprocess.run(command, check=True)

    return f"file://{tmp_dir}"
```