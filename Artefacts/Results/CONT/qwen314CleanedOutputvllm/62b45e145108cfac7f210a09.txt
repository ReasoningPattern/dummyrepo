def check_digests_present_and_used(self, manifest_files, digests_used):
    """
    Check all digests in manifest that are needed are present and used. Return error() in the class.
    """
    regex = self.digest_regex()
    for digest in manifest_files:
        if not regex.match(digest):
            self.error('digest_format_invalid')
        if digest not in digests_used:
            self.error('digest_missing_in_used')