import subprocess
import os
import tarfile
from typing import Optional, Union
import shutil

def prepare_repository_from_archive(
    archive_path: str,
    filename: Optional[str] = None,
    tmp_path: Union[PosixPath, str] = "/tmp",
) -> str:
    tmp_dir = os.path.join(tmp_path, "extracted")
    os.makedirs(tmp_dir, exist_ok=True)
    
    # Extract the archive
    shutil.unpack_archive(archive_path, tmp_dir)
    
    # Construct the URL
    return f"http://{tmp_dir}/"