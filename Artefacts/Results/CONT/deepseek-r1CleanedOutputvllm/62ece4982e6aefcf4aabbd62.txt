from urllib.parse import urlparse, urlunparse

def _replace_url_args(url, url_args):
    parsed = urlparse(url)
    if parsed.netloc:
        base, params = parsed._tuple[:-2]
    else:
        base, params = parsed._tuple, None
    
    new_parts = {base: parsed.scheme + parsed.netloc}
    
    for key, value in url_args.items():
        if key in ['scheme', 'netloc', 'path', 'query', 'fragment']:
            new_parts[key] = value
        else:
            new_parts['query'] = f"{new_parts['query']}?{key}={value}" if new_parts['query'] else f"{key}={value}"
    
    return urlunparse(new_parts)