import bisect

def fill(self, coord, weight=1):
    """
    Fill histogram at *coord* with the given *weight*.

    Coordinates outside the histogram edges are ignored.
    """
    if len(coord) != self.dim:
        return
    bin_indices = []
    for i in range(self.dim):
        edges_i = self.edges[i]
        coord_i = coord[i]
        if coord_i < edges_i[0] or coord_i >= edges_i[-1]:
            return
        bin_index = bisect.bisect_left(edges_i, coord_i)
        bin_indices.append(bin_index)
    self.bins[tuple(bin_indices)] += weight