import logging
import urllib.request
import lxml.etree
import xrd

def retrieve_diaspora_host_meta(host):
    """
    Retrieve a remote Diaspora host-meta document.

    :arg host: Host to retrieve from
    :returns: ``XRD`` instance
    """
    url = f"https://{host}/.well-known/host-meta"
    logging.debug(f"Retrieving host meta from {url}")
    try:
        with urllib.request.urlopen(url) as response:
            xml_content = response.read()
            xrd_xml = lxml.etree.fromstring(xml_content)
            xrd_instance = xrd.XRD(xrd_xml)
            return xrd_instance
    except Exception as e:
        logging.error(f"Failed to retrieve host meta: {e}")
        raise