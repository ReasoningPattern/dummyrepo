

```python
import traceback
import os

def extostr(cls, e, max_level=30, max_path_level=5):
    """
    Format the exception as a string
    """
    def process_path(path, max_path_level):
        parts = path.split(os.path.sep)
        if len(parts) > max_path_level:
            return os.path.sep.join(parts[-max_path_level:])
        return path

    exc_type = type(e).__name__
    exc_msg = str(e)
    result = f"{exc_type}: {exc_msg}\n"
    
    tb_list = traceback.extract_tb(e.__traceback__)
    tb_list = tb_list[-max_level:]  # Take the last max_level frames
    
    for frame in tb_list:
        filename, line_num, func_name, _ = frame
        processed_filename = process_path(filename, max_path_level)
        result += f"  File \"{processed_filename}\", line {line_num}, in {func_name}\n"
    
    return result
```