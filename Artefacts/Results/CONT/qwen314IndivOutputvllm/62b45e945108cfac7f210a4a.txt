

```python
def validate_hierarchy(self, validate_objects=True, check_digests=True, show_warnings=False):
    """
    Validate storage root hierarchy.

    Returns:
        num_objects - number of objects checked
        good_objects - number of objects checked that were found to be valid
    """
    self.num_objects = 0
    self.good_objects = 0
    self.num_traversal_errors = 0

    self.check_root_structure()
    if validate_objects:
        for obj_path in self.object_paths():
            try:
                self.num_objects += 1
                valid = True
                if check_digests:
                    valid = self.validate(obj_path, check_digests=check_digests)
                if valid:
                    self.good_objects += 1
            except Exception as e:
                self.traversal_error(code=1, message=str(e))
                if show_warnings:
                    self.log.warning(f"Validation error for {obj_path}: {str(e)}")
    return self.num_objects, self.good_objects
```