import requests
import xml.etree.ElementTree as ET

class XRD:
    def __init__(self, host, metadata):
        self.host = host
        self.metadata = metadata

def retrieve_diaspora_host_meta(host):
    """
    Retrieve a remote Diaspora host-meta document.

    :arg host: Host to retrieve from
    :returns: ``XRD`` instance
    """
    url = f'https://{host}/host-meta.xml'
    response = requests.get(url)
    if response.status_code != 200:
        raise Exception(f'Failed to retrieve metadata for {host}')
    root = ET.fromstring(response.text)
    metadata = {}
    for child in root:
        metadata[child.tag] = child.text
    return XRD(host, metadata)