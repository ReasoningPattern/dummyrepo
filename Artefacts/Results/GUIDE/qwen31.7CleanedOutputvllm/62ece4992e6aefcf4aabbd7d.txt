import subprocess
import os

def subprocess_run_helper(func, *args, timeout, extra_env=None):
    """Run a function in a subprocess with optional environment and timeout."""
    env = os.environ.copy()
    if extra_env:
        env.update(extra_env)
    return subprocess.run([func] + list(args), timeout=timeout, env=env)