def difference(d1, d2, level=-1):
    def is_in(d, key, level):
        if level < 0:
            level = 0
        if not isinstance(d, dict):
            return False
        if level == 0:
            return key in d
        else:
            current_value = d.get(key)
            if isinstance(current_value, dict):
                return is_in(current_value, key, level - 1)
            else:
                return False

    result = {}
    for key, value in d1.items():
        if not is_in(d2, key, level):
            result[key] = value
    return result