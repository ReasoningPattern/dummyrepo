import urllib.parse

def fetch_content_type(url: str) -> Optional[str]:
    parsed_url = urllib.parse.urlsplit(url)
    path = parsed_url.path
    query = parsed_url.query

    content_type = None

    # Check query parameters for known content types
    if query:
        params = urllib.parse.parse_qs(query)
        for key, values in params.items():
            for value in values:
                value = value.lower()
                if value in {'json', 'html', 'txt', 'application/json', 'text/html', 'text/plain'}:
                    if value == 'json':
                        content_type = 'application/json'
                    elif value == 'html':
                        content_type = 'text/html'
                    elif value == 'txt':
                        content_type = 'text/plain'
                    elif value == 'application/json':
                        content_type = value
                    elif value == 'text/html':
                        content_type = value
                    elif value == 'text/plain':
                        content_type = value
                    break
            if content_type is not None:
                break

    # Check path extension if no query params
    if not content_type and path:
        # Extract filename extension
        filename_ext = None
        path_parts = urllib.parse.urlsplit(path).path.split('/')
        if path_parts:
            filename_ext = path_parts[-1]
        # Define known extensions and their MIME types
        content_type_extensions = {
            '.pdf': 'application/pdf',
            '.png': 'image/png',
            '.jpg': 'image/jpeg',
            '.gif': 'image/gif',
            '.txt': 'text/plain',
            '.log': 'text/plain',
            # Add more extensions as needed
        }
        if filename_ext in content_type_extensions:
            content_type = content_type_extensions[filename_ext]

    # If still not determined, return None
    return content_type