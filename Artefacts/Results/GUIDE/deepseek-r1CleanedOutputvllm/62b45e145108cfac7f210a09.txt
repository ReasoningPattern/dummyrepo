def check_digests_present_and_used(self, manifest_files, digests_used):
    """
    Check all digests in manifest that are needed are present and used. Return error() in the class.
    """
    # Get the available digests from the current context
    available = self.digests_available
    
    # Extract digests from manifest files, using a set to avoid duplicates
    manifest = set()
    for file in manifest_files:
        for digest in file.digests:
            manifest.add(digest)
    
    # Check if all required digests are present
    missing = []
    for digest in manifest:
        if digest not in available:
            missing.append(digest)
    
    # If any digests are missing, report the error
    if missing:
        self.error(f"Missing digests: {missing}")
    else:
        self.check()  # Verify all available digests are used