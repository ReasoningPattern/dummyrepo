

```python
def deep_merge_nodes(nodes):
    from collections import defaultdict
    from collections.abc import Mapping

    groups = defaultdict(list)
    for key, val in nodes:
        groups[key].append(val)

    def deep_merge(a, b):
        merged = a.copy()
        for key in b:
            if key in merged:
                if isinstance(merged[key], Mapping) and isinstance(b[key], Mapping):
                    merged[key] = deep_merge(merged[key], b[key])
                else:
                    merged[key] = b[key]
            else:
                merged[key] = b[key]
        return merged

    result = {}
    for key, values in groups.items():
        if all(isinstance(v, Mapping) for v in values):
            merged = {}
            for v in values:
                merged = deep_merge(merged, v)
            result[key] = merged
        else:
            result[key] = values[-1]
    return result
```