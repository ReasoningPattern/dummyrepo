

```python
def popitem(self):
    if not hasattr(self, 'items') or not self.items:
        raise KeyError("popitem(): pop from empty structure")
    min_freq = min(self.freq.values())
    for key in list(self.items.keys()):
        if self.freq[key] == min_freq:
            value = self.items.pop(key)
            del self.freq[key]
            return (key, value)
    raise RuntimeError("Unreachable code reached")
```