import os

def write_configuration(config_filename, rendered_config, mode=0o600, overwrite=False):
    """
    Given a rendered config YAML, write it out to target file.
    But if the file already exists and overwrite is False,
    abort before writing anything.
    If the file does not exist, create it.
    Write to the file otherwise.

    Returns: None
    """
    if os.path.exists(config_filename) and not overwrite:
        return
    if not os.path.exists(config_filename):
        # Create the file with the given mode
        fd = os.open(config_filename, os.O_CREAT | os.O_WRONLY, mode)
        with os.fdopen(fd, 'w') as f:
            f.write(rendered_config)
    else:
        # overwrite is True, so open in 'w' mode to truncate
        with open(config_filename, 'w') as f:
            f.write(rendered_config)