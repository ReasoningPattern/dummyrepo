

```python
import os

def _resolve_string(matcher):
    """
    Get the value from environment given a matcher containing a name and an optional default value in its group dict.
    If the variable is not defined in environment and no default value is provided, an Error is raised.
    """
    group_dict = matcher.groupdict()
    name = group_dict['name']
    default = group_dict.get('default')

    value = os.environ.get(name, default)
    if value is None and default is None:
        raise ValueError(f"Environment variable '{name}' not found and no default provided.")
    return value
```