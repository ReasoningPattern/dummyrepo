def check_digests_present_and_used(self, manifest_files, digests_used):
    """
    Check all digests in manifest that are needed are present and used. Return error() in the class.
    """
    manifest_digests = set(manifest_files)
    missing = []
    for digest in digests_used:
        if digest not in manifest_digests:
            missing.append(digest)
    if missing:
        return self.error(f"Missing digests in manifest: {missing}")
    return None