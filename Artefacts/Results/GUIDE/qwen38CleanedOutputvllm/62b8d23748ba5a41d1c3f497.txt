import heapq

class LFUCache:
    def __init__(self, capacity):
        self.capacity = capacity
        self.data = {}
        self.freq = {}
        self.heap = []

    def popitem(self):
        """
        Remove and return the `(key, value)` pair least frequently used.
        """
        while self.heap:
            freq, key, value = heapq.heappop(self.heap)
            if self.freq.get(key, 0) == freq:
                del self.data[key]
                del self.freq[key]
                return (key, value)
        raise KeyError("popitem from empty container")