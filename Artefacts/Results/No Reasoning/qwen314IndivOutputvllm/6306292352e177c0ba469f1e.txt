<think>

</think>

```python
def process_text_links(text):
    """
    Process links in text, adding some attributes and linkifying textual links.
    """
    import re
    from urllib.parse import urlparse

    def is_valid_url(url):
        try:
            result = urlparse(url)
            return all([result.scheme, result.netloc])
        except:
            return False

    def add_attributes(match):
        url = match.group(1)
        if is_valid_url(url):
            return f'<a href="{url}" target="_blank" rel="noopener noreferrer">{url}</a>'
        return match.group(0)

    # Linkify URLs
    text = re.sub(r'(https?://\S+)', add_attributes, text)
    # Linkify email addresses
    text = re.sub(r'([a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+)', lambda m: f'<a href="mailto:{m.group(0)}">{m.group(0)}</a>', text)
    return text
```