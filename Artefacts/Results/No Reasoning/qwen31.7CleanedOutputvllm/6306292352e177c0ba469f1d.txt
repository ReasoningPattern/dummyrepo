from typing import Tuple, Set, Callable
from bs4 import BeautifulSoup

def find_tags(text: str, replacer: Callable = None) -> Tuple[Set, str]:
    """
    Find tags in text.
    
    Tries to ignore tags inside code blocks.
    
    Optionally, if passed a "replacer", will also replace the tag word with the result
    of the replacer function called with the tag word.
    
    Returns a set of tags and the original or replaced text.
    """
    soup = BeautifulSoup(text, 'html.parser')
    tags = set()
    
    for tag in soup.find_all(['a', 'span', 'div', 'p', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6']):
        tags.add(tag.name)
    
    if replacer:
        new_text = soup.get_text()
        for tag in tags:
            new_text = new_text.replace(tag, replacer(tag))
        return tags, new_text
    
    return tags, text