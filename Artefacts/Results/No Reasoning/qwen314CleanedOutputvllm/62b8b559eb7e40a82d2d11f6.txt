def determineMetaclass(bases, explicit_mc=None):
    """
    Determine metaclass from 1+ bases and optional explicit __metaclass__
    """
    metaclass = explicit_mc
    for base in bases:
        if hasattr(base, '__metaclass__'):
            if metaclass is None:
                metaclass = base.__metaclass__
            else:
                if metaclass is not base.__metaclass__:
                    raise TypeError("Inconsistent metaclass")
    return metaclass