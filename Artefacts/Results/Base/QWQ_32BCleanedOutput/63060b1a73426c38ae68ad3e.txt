import os
import yaml

def get_plugin_spec_flatten_dict(plugin_dir):
    result = {}
    
    def flatten(d, parent_key='', sep='.'):
        items = []
        for k, v in d.items():
            new_key = f"{parent_key}{sep}{k}" if parent_key else k
            if isinstance(v, dict):
                items.extend(flatten(v, new_key, sep))
            else:
                items.append((new_key, v))
        return items
    
    for fname in os.listdir(plugin_dir):
        if fname.endswith(('.yaml', '.yml')):
            path = os.path.join(plugin_dir, fname)
            with open(path, 'r') as f:
                data = yaml.safe_load(f)
            items = flatten(data)
            result.update(items)
    return result