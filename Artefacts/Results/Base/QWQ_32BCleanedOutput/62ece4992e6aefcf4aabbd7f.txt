from urllib.parse import urlparse
from typing import Tuple

def _parse_image_ref(image_href: str) -> Tuple[str, str, bool]:
    parsed = urlparse(image_href)
    if parsed.scheme not in ('http', 'https'):
        raise ValueError("Invalid scheme; must be http or https")
    if not parsed.netloc:
        raise ValueError("Missing netloc in URL")
    path_parts = parsed.path.strip("/").split("/")
    if not path_parts or not path_parts[-1]:
        raise ValueError("Invalid path; must have an image ID")
    image_id = path_parts[-1]
    use_ssl = parsed.scheme == "https"
    return (image_id, parsed.netloc, use_ssl)