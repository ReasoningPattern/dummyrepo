

```python
from typing import Set, Tuple
import re

def find_tags(text: str, replacer: callable = None) -> Tuple[Set, str]:
    parts = text.split("```")
    tags = set()
    processed = []
    for i, part in enumerate(parts):
        if i % 2 == 0:
            current_tags = re.findall(r'#\S+', part)
            tags.update(current_tags)
            if replacer is not None:
                part = re.sub(r'#\S+', replacer, part)
            processed.append(part)
        else:
            processed.append(part)
    new_text = "```".join(processed)
    return tags, new_text
```