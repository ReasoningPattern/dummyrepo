import requests
import tarfile
import tempfile
import os
from pathlib import Path

def get_repo_archive(url: str, destination_path: Path) -> Path:
    """
    Given an url and a destination path, retrieve and extract .tar.gz archive which contains 'desc' file for each package

        Args:
            url: url of the .tar.gz archive to download
            destination_path: the path on disk where to extract archive
        Returns:
                path where the archive is extracted to
    """
    response = requests.get(url)
    with tempfile.NamedTemporaryFile(delete=False) as temp_file:
        temp_file.write(response.content)
        temp_file_path = temp_file.name
    with tarfile.open(temp_file_path, 'r:gz') as tar:
        tar.extractall(path=str(destination_path))
    os.remove(temp_file_path)
    return destination_path