

```python
def difference(d1, d2, level=-1):
    def compare_dicts(d1, d2, level):
        if level == 0:
            return d1 == d2
        if not (isinstance(d1, dict) and isinstance(d2, dict)):
            return False
        for key in d1:
            if key not in d2:
                return False
            if not compare_dicts(d1[key], d2[key], level - 1):
                return False
        return True
    result = {}
    for key in d1:
        if key not in d2:
            result[key] = d1[key]
        else:
            if compare_dicts(d1[key], d2[key], level):
                result[key] = d1[key]
    return result
```