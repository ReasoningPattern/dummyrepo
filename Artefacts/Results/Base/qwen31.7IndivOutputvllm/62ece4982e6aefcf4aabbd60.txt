

```python
import re

def size_to_bytes(size: str) -> int:
    size = size.strip()
    if not size:
        return 0
    match = re.match(r'^(\d+)([KMGTP])$', size)
    if not match:
        raise ValueError("Invalid size format")
    number = int(match.group(1))
    unit = match.group(2)
    factors = {
        'K': 1024,
        'M': 1024**2,
        'G': 1024**3,
        'T': 1024**4,
        'P': 1024**5,
        'E': 1024**6,
        'Z': 1024**7,
        'Y': 1024**8,
    }
    factor = factors[unit]
    return number * factor
```