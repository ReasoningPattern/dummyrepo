

```python
import re
from typing import Tuple, Set

def find_tags(text: str, replacer: callable = None) -> Tuple[Set[str], str]:
    code_blocks = list(re.finditer(r'```[\s\S]*?```', text, re.DOTALL))
    non_code_parts = []
    start = 0
    for match in code_blocks:
        end = match.start()
        non_code_parts.append(text[start:end])
        start = match.end()
    non_code_parts.append(text[start:])
    
    tags = set()
    modified_parts = []
    for part in non_code_parts:
        tag_matches = re.findall(r'#(\w+)', part)
        tags.update(tag_matches)
        if replacer:
            modified_part = re.sub(r'#(\w+)', lambda m: replacer(m.group(1)), part)
        else:
            modified_part = part
        modified_parts.append(modified_part)
    
    modified_text = ''
    for i, part in enumerate(non_code_parts):
        modified_text += modified_parts[i]
        if i < len(code_blocks):
            modified_text += code_blocks[i].group(0)
    
    return tags, modified_text
```