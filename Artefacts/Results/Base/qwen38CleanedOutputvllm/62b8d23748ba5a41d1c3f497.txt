import heapq

def popitem(self):
    """
    Remove and return the `(key, value)` pair least frequently used.
    """
    while self.heap:
        freq, key = heapq.heappop(self.heap)
        if self.freq.get(key, 0) == freq:
            value = self.data[key]
            del self.data[key]
            del self.freq[key]
            return (key, value)
    raise KeyError("popitem(): dictionary is empty")