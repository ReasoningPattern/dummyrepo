import tarfile
from pathlib import Path
import os
from typing import Optional, Union

def prepare_repository_from_archive(
    archive_path: str,
    filename: Optional[str] = None,
    tmp_path: Union[PosixPath, str] = "/tmp",
) -> str:
    tmp_path = Path(tmp_path)
    tmp_path.mkdir(parents=True, exist_ok=True)
    if filename is None:
        filename = os.path.basename(archive_path)
    extracted_dir = tmp_path / os.path.splitext(filename)[0]
    with tarfile.open(archive_path, 'r:gz') as tar:
        tar.extractall(path=extracted_dir)
    return f"file://{extracted_dir}"