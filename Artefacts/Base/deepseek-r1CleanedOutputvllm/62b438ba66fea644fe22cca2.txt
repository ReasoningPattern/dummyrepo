def deep_merge_nodes(nodes):
    def merge_nodes(existing, new_node):
        if isinstance(existing, MappingNode) and isinstance(new_node, MappingNode):
            merged = MappingNode()
            for key in existing:
                if key in new_node:
                    merged[key] = merge_nodes(existing[key], new_node[key])
                else:
                    merged[key] = new_node[key]
            return merged
        else:
            if isinstance(new_node, MappingNode):
                return new_node
            else:
                return existing

    result = {}
    for node in nodes:
        key = node.key
        if key in result:
            result[key] = merge_nodes(result[key], node)
        else:
            result[key] = node
    return result