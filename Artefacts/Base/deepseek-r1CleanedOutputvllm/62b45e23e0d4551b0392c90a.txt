def validate_version_inventories(self, version_dirs):
    root_inventories = {}
    content_digests = set()
    
    for version_dir in version_dirs:
        # Load inventory and content digests for current version
        current_inventory = self.load_inventory(version_dir)
        current_digests = self.load_content_digests(version_dir)
        
        # Validate inventory
        if current_inventory['version'] in root_inventories:
            expected_inventory = root_inventories[current_inventory['version']]
            if current_inventory != expected_inventory:
                return False
        else:
            # Check content digests
            for digest in current_digests:
                if digest not in content_digests:
                    return False
            root_inventories[current_inventory['version']] = current_inventory
            content_digests.update(current_digests)
    
    return True