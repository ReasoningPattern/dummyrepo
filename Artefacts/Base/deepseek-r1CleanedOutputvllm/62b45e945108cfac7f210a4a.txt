def validate_hierarchy(self, validate_objects=True, check_digests=True, show_warnings=False):
    """
    Validate storage root hierarchy.

    Args:
        validate_objects (bool): Whether to validate each object.
        check_digests (bool): Whether to check the object's digest.
        show_warnings (bool): Whether to show warnings for invalid objects.

    Returns:
        num_objects (int): Number of objects checked.
        good_objects (int): Number of valid objects.
    """
    num_objects = 0
    good_objects = 0
    for obj in self.objects:
        if validate_objects:
            if not obj.validate():
                if show_warnings:
                    print(f"Warning: Object {obj} failed validation check")
                num_objects += 1
            else:
                if check_digests:
                    if obj.digest == self.expected_digest:
                        good_objects += 1
                    else:
                        if show_warnings:
                            print(f"Warning: Object {obj} has invalid digest")
                        num_objects += 1
        else:
            if check_digests:
                if obj.digest == self.expected_digest:
                    good_objects += 1
                else:
                    if show_warnings:
                        print(f"Warning: Object {obj} has invalid digest")
                    num_objects += 1
    return num_objects, good_objects