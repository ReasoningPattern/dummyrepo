def determine_metaclass(bases, explicit_mc=None):
    """
    Determine metaclass from 1+ bases and optional explicit __metaclass__
    """
    if explicit_mc is not None:
        return explicit_mc
    for base in bases:
        base_metaclass = type(base).__metaclass__
        if base_metaclass is not None:
            return base_metaclass
    return type.__metaclass__