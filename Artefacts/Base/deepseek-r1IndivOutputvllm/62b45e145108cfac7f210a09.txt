

```python
import os
import re
from unittest.mock import patch

def check_digests_present_and_used(self, manifest_files, digests_used):
    """
    Check all digests in manifest that are needed are present and used.
    Return error() in the class.
    
    Args:
        manifest_files (list): List of manifest files to check
        digests_used (set): Set of digests that have been used
        
    Raises:
        Exception: If any required digest is missing or not used
    """
    for file_path in manifest_files:
        with open(file_path, 'r') as f:
            content = f.read()
            # Extract digests using regex
            digests = re.findall(r'Digest:\s*(\d+)', content)
            
            for digest in digests:
                if digest not in digests_used:
                    raise self.error(f"Digest {digest} is required but not used")
                
    return

    def error(self, message):
        raise Exception(message)
```