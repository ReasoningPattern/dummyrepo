def validate_version_inventories(self, version_dirs):
    differing_digests = []
    root_digests = set(self.root_inventory.content_digests)
    for version_dir in version_dirs:
        inventory = self.get_version_inventory(version_dir)
        if not inventory:
            raise ValueError(f"Missing inventory for version {version_dir}")
        current_digests = inventory.content_digests
        for digest in current_digests:
            if digest not in root_digests:
                differing_digests.append(digest)
    return differing_digests