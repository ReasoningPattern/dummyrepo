class StorageHierarchy:
    def validate_hierarchy(self, validate_objects=True, check_digests=True, show_warnings=False):
        """
        Validate storage root hierarchy.

        Returns:
            num_objects - number of objects checked
            good_objects - number of objects checked that were found to be valid
        """
        num_objects = 0
        good_objects = 0
        for obj in self.objects:
            num_objects += 1
            valid = True
            if validate_objects:
                valid = obj.validate()
            if check_digests and valid:
                valid = obj.check_digest()
            if valid:
                good_objects += 1
            else:
                if show_warnings:
                    print(f"Warning: {obj} failed validation.")
        return num_objects, good_objects