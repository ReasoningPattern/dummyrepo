import urllib.parse
from typing import Tuple

def _parse_image_ref(image_href: str) -> Tuple[str, str, bool]:
    """
    Parse an image href into composite parts.

    :param image_href: href of an image
    :returns: a tuple of the form (image_id, netloc, use_ssl)
    :raises ValueError:
    """
    parsed = urllib.parse.urlparse(image_href)
    if not parsed.scheme or not parsed.netloc:
        raise ValueError("Invalid URL format")
    use_ssl = parsed.scheme == 'https'
    netloc = parsed.netloc
    filename = parsed.path.split('/')[-1]
    if not filename:
        raise ValueError("Filename is empty")
    image_id = filename.rsplit('.', 1)[0]
    return (image_id, netloc, use_ssl)