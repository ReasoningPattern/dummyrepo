

def validate(self, path):
    if not os.path.isdir(path):
        return False
    versions_dir = os.path.join(path, 'versions')
    if not os.path.isdir(versions_dir):
        return False
    inventory_path = os.path.join(path, 'inventory.json')
    inventory_sha_path = os.path.join(path, 'inventory.json.sha512')
    if not (os.path.exists(inventory_path) or os.path.exists(inventory_sha_path)):
        return False
    versions = [d for d in os.listdir(versions_dir) if d.startswith('v') and d[1:].isdigit() and os.path.isdir(os.path.join(versions_dir, d))]
    if not versions:
        return False
    for v in versions:
        v_path = os.path.join(versions_dir, v)
        state_dir = os.path.join(v_path, 'state')
        content_dir = os.path.join(v_path, 'content')
        if not (os.path.isdir(state_dir) and os.path.isdir(content_dir)):
            return False
    return True